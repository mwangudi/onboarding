@model OnBoarding.ViewModels.UploadedClientViewModel
<div class="row">
	<div class="col-12">
		<div class="row" id="ViewAllUploads">
			<div class="col-lg-12 col-md-12 col-12">
				<div id="UploadsTableContainer"></div>
			</div>
			<script>
				$(document).ready(function () {
					var fileName = '@ViewData["FileName"]';
					$('#UploadsTableContainer').jtable({
						title: '<i class="fa fa-list"></i> Uploaded Clients <div class="jTableTitleDiv float-right"></div>',
						paging: true,
						pageSize: 10,
						sorting: true,
						defaultSorting: 'Id DESC',
						/*selecting: true, //Enable selecting
						multiselect: true, //Allow multiple selecting
						selectingCheckboxes: true, //Show checkboxes on first column
						selectOnRowClick: true, //Enable this to only select using checkboxes*/
						actions:
						{
							listAction: '/DigitalDesk/GetUploadApprovals?FileName=' + fileName,
						},
						fields: {
							Id: {
								key: true,
								create: false,
								edit: false,
								list: false
							},
							CompanyName: {
								title: 'CompanyName',
								width: '25%'
							},
							AcceptedTerms: {
								title: 'Terms',
								width: '10%'
							},
							EMTSignUp: {
								title: 'EMT',
								width: '10%'
							},
							SSI: {
								title: 'SSI',
								width: '7%'
							},
							AccountNumber: {
								title: 'Account-Number',
								width: '15%'
							},
							Currency: {
								title: 'Currency',
								width: '10%'
							},
							RepresentativeName: {
								title: 'RepresentativeName',
								width: '20%'
							},
							RepresentativePhonenumber: {
								title: 'Phone',
								width: '20%'
							},
							RepresentativeLimit: {
								title: 'Limit($)',
								width: '10%'
							},
							IsGM: {
								title: 'ISGM',
								width: '10%'
							},
							IsEMTUser: {
								title: 'EMTUSer',
								width: '10%'
							},
							DateOfContract: {
								title: 'DateOfContract',
								width: '10%'
							},
							ErrorComments: {
								title: 'Error',
								width: '10%'
							},
							Status: {
								title: 'Status',
								width: '10%',
								display: function (data) {
									var approved = data.record.Status;
									if (approved == 1) {
										return '<center><p class="text-success"><i class="fa fa-check-circle"></i> Approved </p></center>';
									}
									else if (approved == 2) {
										return '<center><p class="text-danger"><i class="fa fa-times-circle"></i> Declined </p></center>';
									}
									else if (approved == 3) {
										return '<center><p class="text-danger"><i class="fa fa-times-circle"></i> Error </p></center>';
									}
									else if (approved == 4) {
										return '<center><p class="text-danger"><i class="fa fa-trash"></i> Deleted </p></center>';
									}
                                    else if (approved == 0){
                                        return '<center><p class="text-warning"><i class="fa fa-check-circle"></i> Pending </p></center>';
                                    }
                                    else {
                                        return '<center><i class="fa fa-shield-alt fa-x" style="color:red;"></i></center>';
                                    }
								}
							},
							MyButton: {
								title: 'Action',
								width: '10%',
								display: function (data) {
									var approved = data.record.Status;
									if (approved == 0) {
										return '<center><button class="btn btn-outline-danger w_full btn-small" onclick="LoadUpDeleteModal(\'' + data.record.Id + '\')">' +
											'<span class="fa fa-check-circle"></span> Delete </button></center>';
									}
									else
									{
										return '<center><i class="fa fa-shield-alt fa-x" style="color:red;"></i></center>';
									}
								}
							}
						}
					});

					//Load list from server
					$('#UploadsTableContainer').jtable('load');
										
				});
			</script>
		</div>
	</div>
</div>
<script type="text/javascript">
	//Decline selected items
	function LoadUpDeleteModal(getDelID) {
		Swal.fire({
			title: 'Are you sure?',
			text: "You won't be able to revert this!",
			icon: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#28a745;',
			cancelButtonColor: '#d33',
			confirmButtonText: 'Yes, delete record',
			cancelButtonText: 'No, cancel',
		}).then((result) => {
			if (result.value) {
				$.ajax({
					url: "/DigitalDesk/DeleteSelected",
					type: 'POST',
					data: 'Id=' + getDelID,
					async: true,
					success: function (XmlHttpRequest) {
						if (XmlHttpRequest === 'success') {
							Swal.fire(
								'Success!',
								'Your record has been successfully deleted',
								'success'
							)
							$('#UploadsTableContainer').jtable('load');
						}
						else {
							Swal.fire({
								icon: 'error',
								text: XmlHttpRequest
							})
						}
					}
				})
			}
		})
	}
</script>